#!/usr/bin/env python

# This is the central coordination server executable.

import argparse
import os
import sys

#TODO: Find less hacky way to get our package imported
# Add project root directory (enable symlink, and trunk execution).
PROJECT_ROOT_DIRECTORY = os.path.abspath(
	os.path.dirname(os.path.dirname(os.path.realpath(sys.argv[0]))))

if (os.path.exists(os.path.join(PROJECT_ROOT_DIRECTORY, 'gridtogo'))
    and PROJECT_ROOT_DIRECTORY not in sys.path):
	sys.path.insert(0, PROJECT_ROOT_DIRECTORY)
	os.putenv('PYTHONPATH', PROJECT_ROOT_DIRECTORY) # for subprocesses

from gridtogo.server.servermain import GridToGoServer

port = 8017

parser = argparse.ArgumentParser(description="GridToGo OpenSim Grid Management Server")
parser.add_argument("-p", "--port")
args = parser.parse_args(sys.argv[1:])

if args.port != None:
    port = args.port

if __name__ == "__main__":
    server = GridToGoServer(port)
    server.run()
